<main class="login-container">
  <div class="login-card">
    <header class="login-header">
      <h1>THW Stocktaking</h1>
      <p>Admin Login</p>
    </header>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
      @if (error()) {
        <div class="error-message" role="alert">
          {{ error() }}
        </div>
      }

      <div class="form-field">
        <label for="email">Email</label>
        <input
          id="email"
          type="email"
          formControlName="email"
          autocomplete="email"
          [attr.aria-invalid]="loginForm.controls.email.invalid && loginForm.controls.email.touched"
        />
        @if (loginForm.controls.email.touched && loginForm.controls.email.errors) {
          <span class="field-error">
            @if (loginForm.controls.email.errors['required']) {
              Email is required
            } @else if (loginForm.controls.email.errors['email']) {
              Enter a valid email
            }
          </span>
        }
      </div>

      <div class="form-field">
        <label for="password">Password</label>
        <div class="password-input">
          <input
            id="password"
            [type]="showPassword() ? 'text' : 'password'"
            formControlName="password"
            autocomplete="current-password"
            [attr.aria-invalid]="loginForm.controls.password.invalid && loginForm.controls.password.touched"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'"
          >
            {{ showPassword() ? 'Hide' : 'Show' }}
          </button>
        </div>
        @if (loginForm.controls.password.touched && loginForm.controls.password.errors) {
          <span class="field-error">
            @if (loginForm.controls.password.errors['required']) {
              Password is required
            } @else if (loginForm.controls.password.errors['minlength']) {
              Password must be at least 6 characters
            }
          </span>
        }
      </div>

      <button
        type="submit"
        class="submit-button"
        [disabled]="isLoading()"
      >
        @if (isLoading()) {
          Signing in...
        } @else {
          Sign In
        }
      </button>
    </form>
  </div>
</main>
